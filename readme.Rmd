---
title: tradeR
date: "Last update: `r Sys.time()` by `r system('hostname')` in `r Sys.timezone()`"
output:
  html_document:
    code_folding: "hide"
    theme: sandstone
    highlight: tango
---

```{r}
library("rjson")
```

# Fetch prices
```{r}
# Look for files of interest
files = list.files(path = "tmp", pattern = "*.json", full.names = TRUE)
stopifnot(length(files) > 0)
print(files)

# Get the times from the first coin
raw = fromJSON(file = files[1])
timestamp = c(); for (observation in raw$Data) timestamp = c(timestamp, observation$time)

# Fix time offset (Epoch to friendly units)
timestamp = timestamp - timestamp[1]
timestamp = timestamp / 3600

prices <- cbind(timestamp)

# Add a new column for each coin
for (f in files) {
  raw = fromJSON(file = f)
  p = c(); for (observation in raw$Data) p = c(p, observation$close)
  prices <- cbind(prices, usd = p)
}
```

# Linear regression
```{r}
# X-axis is time
x <- prices[,1]

# Plot prices on the Y-axis
for (i in 3:12) {

  y <- prices[,i]
  relation <- lm(y ~ x)

  par(bg = "gray94")
  plot(x, y, col = "orange", main = files[i - 1], 
       abline(relation, col="red", lty = 10), xlab = "hours", ylab = "USD")
}
```

# Correlation
```{r}
for (i in 3:12) {
  cor(prices[,2], prices[,i])
  plot(prices[,2], prices[,i])
}
```

# Normalise
```{r}
head(prices)
n = prices

for (i in 2:12) {
  n[,i] = n[,i] - max(n[,i])
}
head(n)

matplot(n, pch = 1)
```
