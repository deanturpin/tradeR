---
title: tradeR
date: "Last update: `r Sys.time()` in `r Sys.timezone()`"
output:
  html_document:
    code_folding: "hide"
    theme: sandstone
    highlight: tango
---

```{r}
library("rjson")
```

# Fetch prices
```{r}
files <- list.files(path = "tmp", pattern = "*.json", full.names = TRUE)
stopifnot(length(files) > 0)
files
```

```{r}
extract <- function(f){
  json = fromJSON(file = f)
  sapply(json$Data, function(x) x$open)
}

prices <-as.data.frame(sapply(files, extract))
```

# Linear regression
```{r}
linear_regression <- function(y) {
  x <- 1:length(y) / 60
  relation <- lm(y ~ x)
  plot(x, y, col = "darkgreen", abline(relation), xlab = "hours", ylab = "USD")
}

# names(prices[,1])
sapply(prices, linear_regression)
```

# Normalise
```{r}
normalise <- function(y) {
  low <- min(y)
  high <- max(y)
  y <- y - low
  y <- y / (high - low)
}

normalised <- sapply(prices, normalise)

matplot(normalised, pch = 1)
```
