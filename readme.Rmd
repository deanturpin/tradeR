---
title: tradeR
date: "Last update: `r Sys.time()` in `r Sys.timezone()`"
output:
  html_document:
    code_folding: "hide"
    theme: sandstone
    highlight: tango
---

```{r}
library("rjson")
```

# Fetch prices
```{r}
# Look for files of interest
files <- list.files(path = "tmp", pattern = "*.json", full.names = TRUE)
stopifnot(length(files) > 0)

ignore <- mapply(print, files)
```

```{r}
prices <- c()
extract <- function(f){
  raw = fromJSON(file = f)
  p <- c(); for (observation in raw$Data) p <- c(p, observation$close)
  p
}

prices <- as.data.frame(mapply(extract, files))
summary(prices)
```

# Tableplot
```{r}
require("tabplot")
tableplot(prices)
```

# Linear regression
```{r}
for (y in prices) {

  x <- 1:length(y)
  relation <- lm(y ~ x)

  # plot(n)
  # par(bg = "gray94")
  # plot.new()
  plot(y, col = "orange") # abline(relation)) 
  # , col="red", lty = 10), xlab = "hours", ylab = "USD")
}
```

# Normalise
```{r}
# Take a copy to normalise
n = prices

# for (i in 1:11) {
#   low = min(n[,i])
#   high = max(n[,i])

#   n[,i] = n[,i] - low
#   n[,i] = n[,i] / (high - low)
# }

# matplot(n[,2:12], pch = 1)
```

# Correlation
```{r}
# for (i in 3:12) {
#  cor(prices[,2], prices[,i])
#  plot(prices[,2], prices[,i])
# }
```

